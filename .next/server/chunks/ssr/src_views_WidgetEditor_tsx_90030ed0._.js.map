{"version":3,"sources":["../../../../src/views/WidgetEditor.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter, useParams } from \"next/navigation\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useClipboard } from \"@/contexts/ClipboardContext\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { toast } from \"sonner\";\r\nimport { ArrowLeft, Eye, EyeOff, Monitor, Undo, Redo } from \"lucide-react\";\r\nimport { ComponentsSidebar, ComponentType } from \"@/components/editor/ComponentsSidebar\";\r\nimport { GridCanvas } from \"@/components/editor/GridCanvas\";\r\nimport { Tables } from \"@/integrations/supabase/types\";\r\nimport { SidebarProvider, SidebarTrigger } from \"@/components/ui/sidebar\";\r\nimport { DndContext, DragEndEvent, DragOverEvent, DragStartEvent, pointerWithin } from \"@dnd-kit/core\";\r\nimport { WidgetPreviewModal } from \"@/components/editor/WidgetPreviewModal\";\r\nimport { useHistory } from \"@/hooks/useHistory\";\r\nimport { useKeyboardShortcuts } from \"@/hooks/useKeyboardShortcuts\";\r\nimport { DeviceFrame } from \"@/components/editor/DeviceFrame\";\r\n\r\ntype Widget = Tables<\"widgets\">;\r\ntype WidgetRow = Tables<\"widget_rows\">;\r\ntype WidgetComponent = Tables<\"widget_components\">;\r\n\r\nconst WidgetEditor = () => {\r\n  const params = useParams();\r\n  const widgetId = params.widgetId as string;\r\n  const router = useRouter();\r\n  const { copiedComponent } = useClipboard();\r\n  const [widget, setWidget] = useState<Widget | null>(null);\r\n  const [rows, setRows] = useState<WidgetRow[]>([]);\r\n  const [components, setComponents] = useState<WidgetComponent[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [activeComponentType, setActiveComponentType] = useState<ComponentType | null>(null);\r\n  const [showPreview, setShowPreview] = useState(false);\r\n  const [selectedComponent, setSelectedComponent] = useState<string | null>(null);\r\n\r\n  const history = useHistory();\r\n\r\n  useKeyboardShortcuts({\r\n    onUndo: () => history.canUndo && history.undo(),\r\n    onRedo: () => history.canRedo && history.redo(),\r\n    onDelete: () => selectedComponent && handleDeleteComponent(selectedComponent),\r\n    onDuplicate: () => selectedComponent && handleDuplicateComponent(selectedComponent),\r\n  });\r\n\r\n  useEffect(() => {\r\n    loadWidget();\r\n  }, [widgetId]);\r\n\r\n  const loadWidget = async () => {\r\n    if (!widgetId) return;\r\n\r\n    const { data: widgetData, error: widgetError } = await supabase\r\n      .from(\"widgets\")\r\n      .select(\"*\")\r\n      .eq(\"id\", widgetId)\r\n      .single();\r\n\r\n    if (widgetError) {\r\n      toast.error(\"Failed to load widget\");\r\n      router.push(\"/admin/widgets\");\r\n      return;\r\n    }\r\n\r\n    const { data: rowsData } = await supabase\r\n      .from(\"widget_rows\")\r\n      .select(\"*\")\r\n      .eq(\"widget_id\", widgetId)\r\n      .order(\"position\");\r\n\r\n    const { data: componentsData } = await supabase\r\n      .from(\"widget_components\")\r\n      .select(\"*\")\r\n      .eq(\"widget_id\", widgetId)\r\n      .order(\"position\");\r\n\r\n    setWidget(widgetData);\r\n    setRows(rowsData || []);\r\n    setComponents(componentsData || []);\r\n    setLoading(false);\r\n  };\r\n\r\n  const handleAddRow = async () => {\r\n    if (!widgetId) return;\r\n\r\n    const { data, error } = await supabase\r\n      .from(\"widget_rows\")\r\n      .insert({\r\n        widget_id: widgetId,\r\n        position: rows.length,\r\n        columns: 1,\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      toast.error(\"Failed to add row\");\r\n      return;\r\n    }\r\n\r\n    setRows([...rows, data]);\r\n    toast.success(\"Row added\");\r\n  };\r\n\r\n  const handleDeleteRow = async (rowId: string) => {\r\n    if (!confirm(\"Delete this row and all its components?\")) return;\r\n\r\n    const { error } = await supabase.from(\"widget_rows\").delete().eq(\"id\", rowId);\r\n\r\n    if (error) {\r\n      toast.error(\"Failed to delete row\");\r\n      return;\r\n    }\r\n\r\n    setRows(rows.filter((r) => r.id !== rowId));\r\n    setComponents(components.filter((c) => c.row_id !== rowId));\r\n    toast.success(\"Row deleted\");\r\n  };\r\n\r\n  const handleUpdateRowColumns = async (rowId: string, columns: number) => {\r\n    const oldRow = rows.find((r) => r.id === rowId);\r\n    if (!oldRow) return;\r\n\r\n    history.execute({\r\n      execute: async () => {\r\n        const { error } = await supabase\r\n          .from(\"widget_rows\")\r\n          .update({ columns })\r\n          .eq(\"id\", rowId);\r\n\r\n        if (error) {\r\n          toast.error(\"Failed to update columns\");\r\n          return;\r\n        }\r\n\r\n        setRows(rows.map((r) => (r.id === rowId ? { ...r, columns } : r)));\r\n      },\r\n      undo: async () => {\r\n        await supabase\r\n          .from(\"widget_rows\")\r\n          .update({ columns: oldRow.columns })\r\n          .eq(\"id\", rowId);\r\n        setRows(rows.map((r) => (r.id === rowId ? { ...r, columns: oldRow.columns } : r)));\r\n      },\r\n    });\r\n  };\r\n\r\n  const handleUpdateRowStyles = async (rowId: string, styles: any) => {\r\n    const { error } = await supabase\r\n      .from(\"widget_rows\")\r\n      .update({ styles })\r\n      .eq(\"id\", rowId);\r\n\r\n    if (error) {\r\n      toast.error(\"Failed to update row styles\");\r\n      return;\r\n    }\r\n\r\n    setRows(rows.map((r) => (r.id === rowId ? { ...r, styles } as WidgetRow : r)));\r\n  };\r\n\r\n  const handleUpdateRowColumnWidths = async (rowId: string, widths: number[]) => {\r\n    const { error } = await supabase\r\n      .from(\"widget_rows\")\r\n      .update({ column_widths: widths })\r\n      .eq(\"id\", rowId);\r\n\r\n    if (error) {\r\n      toast.error(\"Failed to update column widths\");\r\n      return;\r\n    }\r\n\r\n    setRows(rows.map((r) => (r.id === rowId ? { ...r, column_widths: widths } as any : r)));\r\n  };\r\n\r\n  const handleUpdateRowResponsiveConfig = async (rowId: string, config: any) => {\r\n    const { error } = await supabase\r\n      .from(\"widget_rows\")\r\n      .update({ responsive_config: config })\r\n      .eq(\"id\", rowId);\r\n\r\n    if (error) {\r\n      toast.error(\"Failed to update responsive config\");\r\n      return;\r\n    }\r\n\r\n    setRows(rows.map((r) => (r.id === rowId ? { ...r, responsive_config: config } as any : r)));\r\n  };\r\n\r\n  const handleUpdateComponentStyles = async (id: string, styles: any) => {\r\n    const { error } = await supabase\r\n      .from(\"widget_components\")\r\n      .update({ styles })\r\n      .eq(\"id\", id);\r\n\r\n    if (error) {\r\n      toast.error(\"Failed to update component styles\");\r\n      return;\r\n    }\r\n\r\n    setComponents(components.map((c) => (c.id === id ? { ...c, styles } as WidgetComponent : c)));\r\n  };\r\n\r\n  const handleReorderRows = async (newRows: WidgetRow[]) => {\r\n    setRows(newRows);\r\n\r\n    for (let i = 0; i < newRows.length; i++) {\r\n      await supabase\r\n        .from(\"widget_rows\")\r\n        .update({ position: i })\r\n        .eq(\"id\", newRows[i].id);\r\n    }\r\n  };\r\n\r\n  const getDefaultContent = (type: ComponentType) => {\r\n    switch (type) {\r\n      case \"heading\": return { text: \"New Heading\", level: \"h2\" };\r\n      case \"paragraph\": return { text: \"New paragraph text\" };\r\n      case \"image\": return { url: \"\", alt: \"Image\" };\r\n      case \"button\": return { text: \"Click me\", link: \"\" };\r\n      case \"link\": return { text: \"Link\", url: \"\" };\r\n      case \"video\": return { url: \"\" };\r\n      case \"divider\": return {};\r\n      case \"spacer\": return { height: \"medium\" };\r\n      case \"quote\": return { text: \"Quote text\", author: \"\" };\r\n      case \"list\": return { items: \"Item 1\\nItem 2\\nItem 3\", type: \"bullet\" };\r\n      case \"code\": return { code: \"console.log('Hello');\", language: \"javascript\" };\r\n      case \"query\": return { queryId: \"\" };\r\n      case \"datasource\": return {\r\n        dataSourceType: \"entity\",\r\n        viewType: \"table\",\r\n        viewOptions: {\r\n          visibleColumns: [],\r\n          sortField: null,\r\n          sortOrder: \"asc\",\r\n          filters: [],\r\n        },\r\n      };\r\n      case \"chart\": return {\r\n        chartType: \"bar\",\r\n        data: JSON.stringify([\r\n          { name: \"Jan\", value: 400 },\r\n          { name: \"Feb\", value: 300 },\r\n          { name: \"Mar\", value: 600 },\r\n          { name: \"Apr\", value: 800 },\r\n          { name: \"May\", value: 500 },\r\n          { name: \"Jun\", value: 700 }\r\n        ], null, 2),\r\n        title: \"Sample Bar Chart\",\r\n        xAxisKey: \"name\",\r\n        yAxisKey: \"value\"\r\n      };\r\n      case \"tabs\": return { tabs: [{ id: \"tab-1\", label: \"Tab 1\", content: \"Content 1\" }, { id: \"tab-2\", label: \"Tab 2\", content: \"Content 2\" }] };\r\n      case \"accordion\": return { items: [{ id: \"item-1\", title: \"Section 1\", content: \"Content 1\" }, { id: \"item-2\", title: \"Section 2\", content: \"Content 2\" }] };\r\n      case \"card\": return { layout: \"image-top\", title: \"Card Title\", description: \"Card description\", imageUrl: \"\", buttonText: \"Learn More\", buttonLink: \"\" };\r\n      case \"form-input\": return { fieldName: \"field_name\", label: \"Field Label\", placeholder: \"Enter value...\", inputType: \"text\", required: false };\r\n      case \"form-textarea\": return { fieldName: \"message\", label: \"Message\", placeholder: \"Enter your message...\", rows: 4, required: false };\r\n      case \"form-select\": return { fieldName: \"select_field\", label: \"Select Option\", placeholder: \"Choose...\", options: \"Option 1\\nOption 2\\nOption 3\", required: false };\r\n      case \"form-checkbox\": return { fieldName: \"checkbox_field\", label: \"Select Options\", options: \"Option 1\\nOption 2\\nOption 3\", type: \"checkbox\", required: false };\r\n      case \"form-submit\": return { buttonText: \"Submit\", buttonVariant: \"default\", successMessage: \"Form submitted successfully!\", submitAction: \"custom\" };\r\n      default: return {};\r\n    }\r\n  };\r\n\r\n  const handleUpdateComponent = async (id: string, content: any) => {\r\n    const { error } = await supabase\r\n      .from(\"widget_components\")\r\n      .update({ content })\r\n      .eq(\"id\", id);\r\n\r\n    if (error) {\r\n      toast.error(\"Failed to update component\");\r\n      return;\r\n    }\r\n\r\n    setComponents(components.map((c) => (c.id === id ? { ...c, content } : c)));\r\n  };\r\n\r\n  const handleDeleteComponent = async (id: string) => {\r\n    const { error } = await supabase.from(\"widget_components\").delete().eq(\"id\", id);\r\n\r\n    if (error) {\r\n      toast.error(\"Failed to delete component\");\r\n      return;\r\n    }\r\n\r\n    setComponents(components.filter((c) => c.id !== id));\r\n    toast.success(\"Component deleted\");\r\n  };\r\n\r\n  const handleInsertTemplate = async (templateData: any) => {\r\n    if (!widgetId) return;\r\n\r\n    const templateRows = templateData.rows || [];\r\n\r\n    for (const templateRow of templateRows) {\r\n      const { data: newRow, error: rowError } = await supabase\r\n        .from(\"widget_rows\")\r\n        .insert({\r\n          widget_id: widgetId,\r\n          position: rows.length,\r\n          columns: templateRow.columns || 1,\r\n          column_widths: templateRow.column_widths || [],\r\n          styles: templateRow.styles || {},\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (rowError || !newRow) {\r\n        toast.error(\"Failed to insert template row\");\r\n        continue;\r\n      }\r\n\r\n      const templateComponents = templateRow.components || [];\r\n      for (const templateComp of templateComponents) {\r\n        await supabase.from(\"widget_components\").insert({\r\n          widget_id: widgetId,\r\n          row_id: newRow.id,\r\n          component_type: templateComp.component_type,\r\n          column_index: templateComp.column_index,\r\n          position: templateComp.position,\r\n          content: templateComp.content || {},\r\n          styles: templateComp.styles || {},\r\n        });\r\n      }\r\n    }\r\n\r\n    await loadWidget();\r\n    toast.success(\"Template inserted successfully\");\r\n  };\r\n\r\n  const handleDuplicateComponent = async (id: string) => {\r\n    const component = components.find((c) => c.id === id);\r\n    if (!component || !widgetId) return;\r\n\r\n    const columnComponents = components.filter(\r\n      (c) => c.row_id === component.row_id && c.column_index === component.column_index\r\n    );\r\n\r\n    const { data, error } = await supabase\r\n      .from(\"widget_components\")\r\n      .insert({\r\n        widget_id: widgetId,\r\n        row_id: component.row_id,\r\n        column_index: component.column_index,\r\n        component_type: component.component_type,\r\n        content: component.content,\r\n        position: columnComponents.length,\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      toast.error(\"Failed to duplicate component\");\r\n      return;\r\n    }\r\n\r\n    setComponents([...components, data]);\r\n    toast.success(\"Component duplicated\");\r\n  };\r\n\r\n  const handlePasteComponent = async (rowId: string, columnIndex: number) => {\r\n    if (!copiedComponent || !widgetId) return;\r\n\r\n    const columnComponents = components.filter(\r\n      (c) => c.row_id === rowId && c.column_index === columnIndex\r\n    );\r\n\r\n    const { data, error } = await supabase\r\n      .from(\"widget_components\")\r\n      .insert({\r\n        widget_id: widgetId,\r\n        row_id: rowId,\r\n        column_index: columnIndex,\r\n        component_type: copiedComponent.component_type,\r\n        content: copiedComponent.content,\r\n        position: columnComponents.length,\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      toast.error(\"Failed to paste component\");\r\n      return;\r\n    }\r\n\r\n    setComponents([...components, data]);\r\n    toast.success(\"Component pasted\");\r\n  };\r\n\r\n  const handleMoveComponentToPosition = async (id: string, newPosition: number) => {\r\n    const component = components.find((c) => c.id === id);\r\n    if (!component) return;\r\n\r\n    const columnComponents = components\r\n      .filter((c) => c.row_id === component.row_id && c.column_index === component.column_index)\r\n      .sort((a, b) => a.position - b.position);\r\n\r\n    const updates = columnComponents.map((comp, index) => {\r\n      if (comp.id === id) {\r\n        return supabase.from(\"widget_components\").update({ position: newPosition }).eq(\"id\", comp.id);\r\n      }\r\n      if (index >= newPosition && comp.position < component.position) {\r\n        return supabase.from(\"widget_components\").update({ position: index + 1 }).eq(\"id\", comp.id);\r\n      }\r\n      if (index <= newPosition && comp.position > component.position) {\r\n        return supabase.from(\"widget_components\").update({ position: index - 1 }).eq(\"id\", comp.id);\r\n      }\r\n      return null;\r\n    }).filter(Boolean);\r\n\r\n    await Promise.all(updates);\r\n    await loadWidget();\r\n    toast.success(\"Component moved\");\r\n  };\r\n\r\n  const handleAddRowAbove = async (rowId: string) => {\r\n    const targetRow = rows.find((r) => r.id === rowId);\r\n    if (!targetRow || !widgetId) return;\r\n\r\n    const { error } = await supabase.from(\"widget_rows\").insert({\r\n      widget_id: widgetId,\r\n      position: targetRow.position,\r\n      columns: 1,\r\n    });\r\n\r\n    if (error) {\r\n      toast.error(\"Failed to add row\");\r\n      return;\r\n    }\r\n\r\n    const rowsToUpdate = rows.filter((r) => r.position >= targetRow.position);\r\n    await Promise.all(\r\n      rowsToUpdate.map((r) =>\r\n        supabase.from(\"widget_rows\").update({ position: r.position + 1 }).eq(\"id\", r.id)\r\n      )\r\n    );\r\n\r\n    await loadWidget();\r\n    toast.success(\"Row added\");\r\n  };\r\n\r\n  const handleAddRowBelow = async (rowId: string) => {\r\n    const targetRow = rows.find((r) => r.id === rowId);\r\n    if (!targetRow || !widgetId) return;\r\n\r\n    const { error } = await supabase.from(\"widget_rows\").insert({\r\n      widget_id: widgetId,\r\n      position: targetRow.position + 1,\r\n      columns: 1,\r\n    });\r\n\r\n    if (error) {\r\n      toast.error(\"Failed to add row\");\r\n      return;\r\n    }\r\n\r\n    const rowsToUpdate = rows.filter((r) => r.position > targetRow.position);\r\n    await Promise.all(\r\n      rowsToUpdate.map((r) =>\r\n        supabase.from(\"widget_rows\").update({ position: r.position + 1 }).eq(\"id\", r.id)\r\n      )\r\n    );\r\n\r\n    await loadWidget();\r\n    toast.success(\"Row added\");\r\n  };\r\n\r\n  const handleDuplicateRow = async (rowId: string) => {\r\n    const targetRow = rows.find((r) => r.id === rowId);\r\n    if (!targetRow || !widgetId) return;\r\n\r\n    const { data: newRow, error: rowError } = await supabase\r\n      .from(\"widget_rows\")\r\n      .insert({\r\n        widget_id: widgetId,\r\n        position: targetRow.position + 1,\r\n        columns: targetRow.columns,\r\n        styles: targetRow.styles,\r\n        column_widths: targetRow.column_widths,\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (rowError || !newRow) {\r\n      toast.error(\"Failed to duplicate row\");\r\n      return;\r\n    }\r\n\r\n    const rowComponents = components.filter((c) => c.row_id === rowId);\r\n    await Promise.all(\r\n      rowComponents.map((comp) =>\r\n        supabase.from(\"widget_components\").insert({\r\n          widget_id: widgetId,\r\n          row_id: newRow.id,\r\n          column_index: comp.column_index,\r\n          position: comp.position,\r\n          component_type: comp.component_type,\r\n          content: comp.content,\r\n          styles: comp.styles,\r\n        })\r\n      )\r\n    );\r\n\r\n    await loadWidget();\r\n    toast.success(\"Row duplicated\");\r\n  };\r\n\r\n  const handleDragStart = (event: DragStartEvent) => {\r\n    const { active } = event;\r\n    const activeData = active.data.current;\r\n\r\n    if (activeData?.type === \"new-component\") {\r\n      setActiveComponentType(activeData.componentType);\r\n    }\r\n  };\r\n\r\n  const handleDragOver = (event: DragOverEvent) => {\r\n    const { active, over } = event;\r\n    if (!over) return;\r\n\r\n    const activeId = active.id as string;\r\n    const activeData = active.data.current;\r\n    const overData = over.data.current;\r\n\r\n    if (activeData?.type === \"component\" && overData?.type === \"droppable-column\") {\r\n      const component = activeData.component;\r\n      const targetRowId = overData.rowId;\r\n      const targetColumnIndex = overData.columnIndex;\r\n\r\n      if (component.row_id !== targetRowId || component.column_index !== targetColumnIndex) {\r\n        setComponents(\r\n          components.map((c) =>\r\n            c.id === activeId\r\n              ? { ...c, row_id: targetRowId, column_index: targetColumnIndex }\r\n              : c\r\n          )\r\n        );\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDragEnd = async (event: DragEndEvent) => {\r\n    const { active, over } = event;\r\n\r\n    if (!over) {\r\n      setActiveComponentType(null);\r\n      return;\r\n    }\r\n\r\n    const activeId = active.id as string;\r\n    const activeData = active.data.current;\r\n    const overData = over.data.current;\r\n\r\n    if (activeId.startsWith(\"new-\") && activeData?.type === \"new-component\") {\r\n      const targetRowId = overData?.rowId;\r\n      const targetColumnIndex = overData?.columnIndex;\r\n\r\n      if (!targetRowId || targetColumnIndex === null || !widgetId) {\r\n        setActiveComponentType(null);\r\n        return;\r\n      }\r\n\r\n      const componentType = activeData.componentType;\r\n      const columnComponents = components.filter(\r\n        (c) => c.row_id === targetRowId && c.column_index === targetColumnIndex\r\n      );\r\n\r\n      const { data, error } = await supabase\r\n        .from(\"widget_components\")\r\n        .insert({\r\n          widget_id: widgetId,\r\n          row_id: targetRowId,\r\n          column_index: targetColumnIndex,\r\n          component_type: componentType,\r\n          content: getDefaultContent(componentType),\r\n          position: columnComponents.length,\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        toast.error(\"Failed to add component\");\r\n      } else {\r\n        setComponents([...components, data]);\r\n        toast.success(\"Component added\");\r\n      }\r\n\r\n      setActiveComponentType(null);\r\n      return;\r\n    }\r\n\r\n    const component = components.find((c) => c.id === activeId);\r\n    if (!component) {\r\n      setActiveComponentType(null);\r\n      return;\r\n    }\r\n\r\n    await supabase\r\n      .from(\"widget_components\")\r\n      .update({\r\n        row_id: component.row_id,\r\n        column_index: component.column_index,\r\n      })\r\n      .eq(\"id\", activeId);\r\n\r\n    const columnComponents = components\r\n      .filter((c) => c.row_id === component.row_id && c.column_index === component.column_index)\r\n      .sort((a, b) => a.position - b.position);\r\n\r\n    for (let i = 0; i < columnComponents.length; i++) {\r\n      await supabase\r\n        .from(\"widget_components\")\r\n        .update({ position: i })\r\n        .eq(\"id\", columnComponents[i].id);\r\n    }\r\n\r\n    setActiveComponentType(null);\r\n  };\r\n\r\n  const handlePublishToggle = async () => {\r\n    if (!widget) return;\r\n\r\n    const { error } = await supabase\r\n      .from(\"widgets\")\r\n      .update({ is_published: !widget.is_published })\r\n      .eq(\"id\", widget.id);\r\n\r\n    if (error) {\r\n      toast.error(\"Failed to update widget\");\r\n      return;\r\n    }\r\n\r\n    setWidget({ ...widget, is_published: !widget.is_published });\r\n    toast.success(widget.is_published ? \"Widget unpublished\" : \"Widget published\");\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"min-h-screen flex items-center justify-center\">Loading...</div>;\r\n  }\r\n\r\n  return (\r\n    <DndContext\r\n      collisionDetection={pointerWithin}\r\n      onDragStart={handleDragStart}\r\n      onDragEnd={handleDragEnd}\r\n      onDragOver={handleDragOver}\r\n    >\r\n      <SidebarProvider>\r\n        <div className=\"min-h-screen flex w-full bg-background\">\r\n          <ComponentsSidebar />\r\n\r\n          <div className=\"flex-1 flex flex-col\">\r\n            <header className=\"border-b bg-card shadow-[var(--shadow-soft)] sticky top-0 z-50\">\r\n              <div className=\"px-4 py-3 flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <SidebarTrigger />\r\n                  <Button variant=\"outline\" onClick={() => router.push(\"/admin/widgets\")} className=\"gap-2\">\r\n                    <ArrowLeft className=\"h-4 w-4\" />\r\n                    Back\r\n                  </Button>\r\n                  <h1 className=\"text-xl font-bold\">{widget?.title}</h1>\r\n                </div>\r\n                <div className=\"flex items-center gap-3\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"icon\"\r\n                    onClick={() => history.undo()}\r\n                    disabled={!history.canUndo}\r\n                    title=\"Undo (Cmd+Z)\"\r\n                  >\r\n                    <Undo className=\"h-4 w-4\" />\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"icon\"\r\n                    onClick={() => history.redo()}\r\n                    disabled={!history.canRedo}\r\n                    title=\"Redo (Cmd+Shift+Z)\"\r\n                  >\r\n                    <Redo className=\"h-4 w-4\" />\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => setShowPreview(true)}\r\n                    className=\"gap-2\"\r\n                  >\r\n                    <Monitor className=\"h-4 w-4\" />\r\n                    Preview\r\n                  </Button>\r\n                  <Button\r\n                    variant={widget?.is_published ? \"outline\" : \"default\"}\r\n                    onClick={handlePublishToggle}\r\n                    className=\"gap-2\"\r\n                  >\r\n                    {widget?.is_published ? (\r\n                      <>\r\n                        <EyeOff className=\"h-4 w-4\" />\r\n                        Unpublish\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <Eye className=\"h-4 w-4\" />\r\n                        Publish\r\n                      </>\r\n                    )}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </header>\r\n\r\n            <main className=\"flex-1 overflow-auto px-4 py-8\">\r\n              <GridCanvas\r\n                rows={rows}\r\n                components={components}\r\n                onUpdateComponent={handleUpdateComponent}\r\n                onUpdateComponentStyles={handleUpdateComponentStyles}\r\n                onDeleteComponent={handleDeleteComponent}\r\n                onAddRow={handleAddRow}\r\n                onDeleteRow={handleDeleteRow}\r\n                onUpdateRowColumns={handleUpdateRowColumns}\r\n                onUpdateRowStyles={handleUpdateRowStyles}\r\n                onUpdateRowColumnWidths={handleUpdateRowColumnWidths}\r\n                onUpdateRowResponsiveConfig={handleUpdateRowResponsiveConfig}\r\n                onReorderRows={handleReorderRows}\r\n                activeComponentType={activeComponentType}\r\n                onDuplicateComponent={handleDuplicateComponent}\r\n                onPasteComponent={handlePasteComponent}\r\n                onInsertTemplate={handleInsertTemplate}\r\n                onMoveComponentToPosition={handleMoveComponentToPosition}\r\n                onAddRowAbove={handleAddRowAbove}\r\n                onAddRowBelow={handleAddRowBelow}\r\n                onDuplicateRow={handleDuplicateRow}\r\n              />\r\n            </main>\r\n          </div>\r\n        </div>\r\n      </SidebarProvider>\r\n\r\n      <WidgetPreviewModal\r\n        open={showPreview}\r\n        onOpenChange={setShowPreview}\r\n        widget={widget}\r\n        rows={rows}\r\n        components={components}\r\n      />\r\n    </DndContext>\r\n  );\r\n};\r\n\r\nexport default WidgetEditor;\r\n"],"names":[],"mappings":"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"}