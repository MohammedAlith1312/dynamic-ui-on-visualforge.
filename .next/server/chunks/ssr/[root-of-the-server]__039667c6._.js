module.exports=[36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},29246,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("textarea",{className:(0,d.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:e,...c}));e.displayName="Textarea",a.s(["Textarea",()=>e])},49967,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(14574),e=a.i(99570),f=a.i(33508),g=a.i(98212),h=a.i(70514),i=a.i(66605);a.s(["PagePreviewModal",0,({open:a,onOpenChange:j,page:k,rows:l,components:m,layout:n,layoutRows:o,layoutComponents:p,widgetData:q})=>{let[r,s]=(0,c.useState)("desktop"),t=(a,c)=>a.sort((a,b)=>a.position-b.position).map(a=>{let d=c.filter(b=>b.row_id===a.id).sort((a,b)=>a.position-b.position),e=Array.from({length:a.columns},()=>[]);return d.forEach(b=>{b.column_index<a.columns&&e[b.column_index].push(b)}),(0,b.jsx)("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${a.columns}, 1fr)`},children:e.map((a,c)=>(0,b.jsx)("div",{className:"space-y-4",children:a.map(a=>{if("page-content"===a.component_type)return(0,b.jsx)("div",{className:"w-full",children:t(l,m)},a.id);if("is_widget_instance"in a&&a.is_widget_instance&&a.widget_id){var c;let d;return(0,b.jsx)("div",{children:(c=a.widget_id,(d=q.get(c))?d.rows.sort((a,b)=>a.position-b.position).map(a=>{let c=d.components.filter(b=>b.row_id===a.id).sort((a,b)=>a.position-b.position),e=Array.from({length:a.columns},()=>[]);return c.forEach(b=>{b.column_index<a.columns&&e[b.column_index].push(b)}),(0,b.jsx)("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${a.columns}, 1fr)`},children:e.map((a,c)=>(0,b.jsx)("div",{className:"space-y-4",children:a.map(a=>(0,b.jsx)(g.ComponentRenderer,{component:a},a.id))},c))},a.id)}):(0,b.jsx)("div",{className:"p-4 border border-dashed border-muted-foreground/30 rounded-lg",children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Widget not found"})}))},a.id)}return(0,b.jsx)(g.ComponentRenderer,{component:a},a.id)})},c))},a.id)});return(0,b.jsx)(d.Dialog,{open:a,onOpenChange:j,children:(0,b.jsxs)(d.DialogContent,{className:"max-w-[95vw] max-h-[90vh] p-0 gap-0",hideClose:!0,children:[(0,b.jsxs)(d.DialogTitle,{className:"sr-only",children:["Page Preview: ",k?.title]}),(0,b.jsxs)("div",{className:"flex items-center justify-between border-b px-4 py-3 bg-card",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold","aria-hidden":"true",children:["Page Preview: ",k?.title]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(h.ResponsiveControls,{currentBreakpoint:r,onBreakpointChange:s}),(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",onClick:()=>j(!1),children:(0,b.jsx)(f.X,{className:"h-4 w-4"})})]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-auto bg-background",children:(0,b.jsx)(i.DeviceFrame,{breakpoint:r,children:(0,b.jsxs)("div",{className:"min-h-full",children:[n?t(o,p):(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:t(l,m)}),0===l.length&&(0,b.jsx)("p",{className:"text-center text-muted-foreground py-12",children:"No content yet. Add rows and components to see the preview."})]})})})]})})}])},21118,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(14574),e=a.i(99570),f=a.i(33508),g=a.i(98212),h=a.i(70514),i=a.i(66605);a.s(["WidgetPreviewModal",0,({open:a,onOpenChange:j,widget:k,rows:l,components:m})=>{let[n,o]=(0,c.useState)("desktop");return(0,b.jsx)(d.Dialog,{open:a,onOpenChange:j,children:(0,b.jsxs)(d.DialogContent,{className:"max-w-[95vw] max-h-[90vh] p-0 gap-0",hideClose:!0,children:[(0,b.jsxs)(d.DialogTitle,{className:"sr-only",children:["Widget Preview: ",k?.title]}),(0,b.jsxs)("div",{className:"flex items-center justify-between border-b px-4 py-3 bg-card",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold","aria-hidden":"true",children:["Widget Preview: ",k?.title]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(h.ResponsiveControls,{currentBreakpoint:n,onBreakpointChange:o}),(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",onClick:()=>j(!1),children:(0,b.jsx)(f.X,{className:"h-4 w-4"})})]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-auto bg-background",children:(0,b.jsx)(i.DeviceFrame,{breakpoint:n,children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto p-8 space-y-8",children:[l.sort((a,b)=>a.position-b.position).map(a=>{let c=m.filter(b=>b.row_id===a.id).sort((a,b)=>a.position-b.position),d=Array.from({length:a.columns},()=>[]);return c.forEach(b=>{b.column_index<a.columns&&d[b.column_index].push(b)}),(0,b.jsx)("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${a.columns}, 1fr)`},children:d.map((a,c)=>(0,b.jsx)("div",{className:"space-y-4",children:a.map(a=>(0,b.jsx)(g.ComponentRenderer,{component:a},a.id))},c))},a.id)}),0===l.length&&(0,b.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"No content yet. Add rows and components to see the preview."})]})})})]})})}])},63422,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(14574),e=a.i(99570),f=a.i(33508),g=a.i(98212),h=a.i(70514),i=a.i(66605);a.s(["LayoutPreviewModal",0,({open:a,onOpenChange:j,layout:k,rows:l,components:m})=>{let[n,o]=(0,c.useState)("desktop");return(0,b.jsx)(d.Dialog,{open:a,onOpenChange:j,children:(0,b.jsxs)(d.DialogContent,{className:"max-w-[95vw] max-h-[90vh] p-0 gap-0",hideClose:!0,children:[(0,b.jsxs)(d.DialogTitle,{className:"sr-only",children:["Layout Preview: ",k?.title]}),(0,b.jsxs)("div",{className:"flex items-center justify-between border-b px-4 py-3 bg-card",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold","aria-hidden":"true",children:["Layout Preview: ",k?.title]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(h.ResponsiveControls,{currentBreakpoint:n,onBreakpointChange:o}),(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",onClick:()=>j(!1),children:(0,b.jsx)(f.X,{className:"h-4 w-4"})})]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-auto bg-background",children:(0,b.jsx)(i.DeviceFrame,{breakpoint:n,children:(0,b.jsxs)("div",{className:"min-h-full flex flex-col",children:[l.sort((a,b)=>a.position-b.position).map(a=>{let c=m.filter(b=>b.row_id===a.id).sort((a,b)=>a.position-b.position),d=Array.from({length:a.columns},()=>[]);return c.forEach(b=>{b.column_index<a.columns&&d[b.column_index].push(b)}),(0,b.jsx)("div",{className:"w-full",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-8 grid gap-4",style:{gridTemplateColumns:`repeat(${a.columns}, 1fr)`},children:d.map((a,c)=>(0,b.jsx)("div",{className:"space-y-4",children:a.map(a=>(0,b.jsx)(g.ComponentRenderer,{component:a},a.id))},c))})},a.id)}),0===l.length&&(0,b.jsx)("p",{className:"text-center text-muted-foreground py-12",children:"No content yet. Add rows and components to see the preview."})]})})})]})})}])},43835,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(74167),f=a.i(99570),g=a.i(91119),h=a.i(86304),i=a.i(20494),j=a.i(15618),k=a.i(77156),l=a.i(24569),m=a.i(81560),n=a.i(77430),o=a.i(14574),p=a.i(66718),q=a.i(70430),r=a.i(29246),s=a.i(80701);function t({open:a,onOpenChange:g}){let h=(0,d.useRouter)(),{toast:i}=(0,n.useToast)(),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)("flat"),x=async()=>{if(!l.trim())return void i({title:"Display name required",description:"Please enter a display name for the query.",variant:"destructive"});k(!0);try{let{data:a}=await e.supabase.auth.getUser();if(!a.user)throw Error("Not authenticated");let b=l.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),{data:c,error:d}=await e.supabase.from("queries").insert({user_id:a.user.id,name:b,display_name:l,description:t||null,query_type:v}).select().single();if(d)throw d;i({title:"Query created",description:"Your query has been created successfully."}),g(!1),m(""),u(""),w("flat"),h.push(`/admin/queries/${c.id}/editor`)}catch(a){i({title:"Error creating query",description:a.message,variant:"destructive"})}finally{k(!1)}};return(0,b.jsx)(o.Dialog,{open:a,onOpenChange:g,children:(0,b.jsxs)(o.DialogContent,{children:[(0,b.jsxs)(o.DialogHeader,{children:[(0,b.jsx)(o.DialogTitle,{children:"Create New Query"}),(0,b.jsx)(o.DialogDescription,{children:"Build a new database query to display dynamic data"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(q.Label,{htmlFor:"displayName",children:"Display Name"}),(0,b.jsx)(p.Input,{id:"displayName",value:l,onChange:a=>m(a.target.value),placeholder:"My Query"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(q.Label,{htmlFor:"description",children:"Description (optional)"}),(0,b.jsx)(r.Textarea,{id:"description",value:t,onChange:a=>u(a.target.value),placeholder:"What does this query do?",rows:3})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(q.Label,{htmlFor:"queryType",children:"Query Type"}),(0,b.jsxs)(s.Select,{value:v,onValueChange:a=>w(a),children:[(0,b.jsx)(s.SelectTrigger,{children:(0,b.jsx)(s.SelectValue,{})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"flat",children:"Flat (List Records)"}),(0,b.jsx)(s.SelectItem,{value:"aggregate",children:"Aggregate (Group & Calculate)"})]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"flat"===v?"Display individual records from one or more entities":"Group records and calculate sums, counts, averages, etc."})]})]}),(0,b.jsxs)(o.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),(0,b.jsx)(f.Button,{onClick:x,disabled:j,children:j?"Creating...":"Create Query"})]})]})})}var u=a.i(97292);function v(){let a=(0,d.useRouter)(),{toast:o}=(0,n.useToast)(),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)(!0),[v,w]=(0,c.useState)(!1);(0,c.useEffect)(()=>{x();let a=e.supabase.channel("queries-changes").on("postgres_changes",{event:"*",schema:"public",table:"queries"},()=>{x()}).subscribe();return()=>{e.supabase.removeChannel(a)}},[]);let x=async()=>{try{let{data:a,error:b}=await e.supabase.from("queries").select("*").order("created_at",{ascending:!1});if(b)throw b;q(a||[])}catch(a){o({title:"Error loading queries",description:a.message,variant:"destructive"})}finally{s(!1)}},y=async a=>{if(confirm("Are you sure you want to delete this query?"))try{let{error:b}=await e.supabase.from("queries").delete().eq("id",a);if(b)throw b;o({title:"Query deleted",description:"The query has been deleted successfully."})}catch(a){o({title:"Error deleting query",description:a.message,variant:"destructive"})}};return(0,b.jsx)(u.AdminLayout,{children:(0,b.jsxs)("div",{className:"p-8",children:[(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-4xl font-bold mb-2",children:"Queries"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Build and manage database queries"})]}),(0,b.jsxs)(f.Button,{onClick:()=>w(!0),"data-create-query":!0,children:[(0,b.jsx)(j.Plus,{className:"mr-2 h-4 w-4"}),"New Query"]})]}),r?(0,b.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:"Loading queries..."}):0===p.length?(0,b.jsx)(g.Card,{children:(0,b.jsxs)(g.CardContent,{className:"flex flex-col items-center justify-center py-12",children:[(0,b.jsx)(i.Database,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No queries yet"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Create your first query to start building dynamic data views"}),(0,b.jsxs)(f.Button,{onClick:()=>w(!0),children:[(0,b.jsx)(j.Plus,{className:"mr-2 h-4 w-4"}),"Create Query"]})]})}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(c=>(0,b.jsxs)(g.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)("div",{className:"flex justify-between items-start",children:(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)(g.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Database,{className:"h-5 w-5"}),c.display_name]}),(0,b.jsx)(g.CardDescription,{className:"mt-2",children:c.description||"No description"})]})}),(0,b.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,b.jsx)(h.Badge,{variant:"flat"===c.query_type?"default":"secondary",children:c.query_type}),c.is_published&&(0,b.jsx)(h.Badge,{variant:"outline",children:"Published"})]})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>a.push(`/admin/queries/${c.id}/results`),children:[(0,b.jsx)(k.Eye,{className:"h-4 w-4 mr-1"}),"View Results"]}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>a.push(`/admin/queries/${c.id}/editor`),children:[(0,b.jsx)(l.Edit,{className:"h-4 w-4 mr-1"}),"Edit"]}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>y(c.id),children:(0,b.jsx)(m.Trash2,{className:"h-4 w-4"})})]})})]},c.id))})]}),(0,b.jsx)(t,{open:v,onOpenChange:w})]})})}a.s(["default",()=>v],43835)},59789,a=>{a.v(a=>Promise.resolve().then(()=>a(23952)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__039667c6._.js.map