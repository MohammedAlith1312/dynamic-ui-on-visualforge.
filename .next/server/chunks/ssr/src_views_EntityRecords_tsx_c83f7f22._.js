module.exports=[93353,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(74167),f=a.i(99570),g=a.i(66718),h=a.i(23292),i=a.i(210),j=a.i(15618),k=a.i(24569),l=a.i(81560),m=a.i(77156),n=a.i(41379),o=a.i(70106);let p=(0,o.default)("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);var q=a.i(38790),r=a.i(57064),s=a.i(28886),t=a.i(89816),u=a.i(67329),v=a.i(41710),w=a.i(41675),x=a.i(39761),y=a.i(50104),z=a.i(30553),A=a.i(24050),B=a.i(7554),C=a.i(25152),D="Toggle",E=c.forwardRef((a,c)=>{let{pressed:d,defaultPressed:e,onPressedChange:f,...g}=a,[h,i]=(0,C.useControllableState)({prop:d,onChange:f,defaultProp:e??!1,caller:D});return(0,b.jsx)(z.Primitive.button,{type:"button","aria-pressed":h,"data-state":h?"on":"off","data-disabled":a.disabled?"":void 0,...g,ref:c,onClick:(0,B.composeEventHandlers)(a.onClick,()=>{a.disabled||i(!h)})})});E.displayName=D;var F=a.i(7827),G="ToggleGroup",[H,I]=(0,y.createContextScope)(G,[A.createRovingFocusGroupScope]),J=(0,A.createRovingFocusGroupScope)(),K=c.default.forwardRef((a,c)=>{let{type:d,...e}=a;if("single"===d)return(0,b.jsx)(N,{...e,ref:c});if("multiple"===d)return(0,b.jsx)(O,{...e,ref:c});throw Error(`Missing prop \`type\` expected on \`${G}\``)});K.displayName=G;var[L,M]=H(G),N=c.default.forwardRef((a,d)=>{let{value:e,defaultValue:f,onValueChange:g=()=>{},...h}=a,[i,j]=(0,C.useControllableState)({prop:e,defaultProp:f??"",onChange:g,caller:G});return(0,b.jsx)(L,{scope:a.__scopeToggleGroup,type:"single",value:c.default.useMemo(()=>i?[i]:[],[i]),onItemActivate:j,onItemDeactivate:c.default.useCallback(()=>j(""),[j]),children:(0,b.jsx)(R,{...h,ref:d})})}),O=c.default.forwardRef((a,d)=>{let{value:e,defaultValue:f,onValueChange:g=()=>{},...h}=a,[i,j]=(0,C.useControllableState)({prop:e,defaultProp:f??[],onChange:g,caller:G}),k=c.default.useCallback(a=>j((b=[])=>[...b,a]),[j]),l=c.default.useCallback(a=>j((b=[])=>b.filter(b=>b!==a)),[j]);return(0,b.jsx)(L,{scope:a.__scopeToggleGroup,type:"multiple",value:i,onItemActivate:k,onItemDeactivate:l,children:(0,b.jsx)(R,{...h,ref:d})})});K.displayName=G;var[P,Q]=H(G),R=c.default.forwardRef((a,c)=>{let{__scopeToggleGroup:d,disabled:e=!1,rovingFocus:f=!0,orientation:g,dir:h,loop:i=!0,...j}=a,k=J(d),l=(0,F.useDirection)(h),m={role:"group",dir:l,...j};return(0,b.jsx)(P,{scope:d,rovingFocus:f,disabled:e,children:f?(0,b.jsx)(A.Root,{asChild:!0,...k,orientation:g,dir:l,loop:i,children:(0,b.jsx)(z.Primitive.div,{...m,ref:c})}):(0,b.jsx)(z.Primitive.div,{...m,ref:c})})}),S="ToggleGroupItem",T=c.default.forwardRef((a,d)=>{let e=M(S,a.__scopeToggleGroup),f=Q(S,a.__scopeToggleGroup),g=J(a.__scopeToggleGroup),h=e.value.includes(a.value),i=f.disabled||a.disabled,j={...a,pressed:h,disabled:i},k=c.default.useRef(null);return f.rovingFocus?(0,b.jsx)(A.Item,{asChild:!0,...g,focusable:!i,active:h,ref:k,children:(0,b.jsx)(U,{...j,ref:d})}):(0,b.jsx)(U,{...j,ref:d})});T.displayName=S;var U=c.default.forwardRef((a,c)=>{let{__scopeToggleGroup:d,value:e,...f}=a,g=M(S,d),h={role:"radio","aria-checked":a.pressed,"aria-pressed":void 0},i="single"===g.type?h:void 0;return(0,b.jsx)(E,{...i,...f,ref:c,onPressedChange:a=>{a?g.onItemActivate(e):g.onItemDeactivate(e)}})}),V=a.i(68114);let W=(0,a.i(187).cva)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}});c.forwardRef(({className:a,variant:c,size:d,...e},f)=>(0,b.jsx)(E,{ref:f,className:(0,V.cn)(W({variant:c,size:d,className:a})),...e})).displayName=E.displayName;let X=c.createContext({size:"default",variant:"default"}),Y=c.forwardRef(({className:a,variant:c,size:d,children:e,...f},g)=>(0,b.jsx)(K,{ref:g,className:(0,V.cn)("flex items-center justify-center gap-1",a),...f,children:(0,b.jsx)(X.Provider,{value:{variant:c,size:d},children:e})}));Y.displayName=K.displayName;let Z=c.forwardRef(({className:a,children:d,variant:e,size:f,...g},h)=>{let i=c.useContext(X);return(0,b.jsx)(T,{ref:h,className:(0,V.cn)(W({variant:i.variant||e,size:i.size||f}),a),...g,children:d})});Z.displayName=T.displayName;var $=a.i(97292),_=a.i(91119),aa=a.i(14574),ab=a.i(70430),ac=a.i(29246),ad=a.i(63658),ae=a.i(34767),af=a.i(98251);let ag=({open:a,onOpenChange:d,entityId:i,fields:j,record:k,onSuccess:l})=>{let[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)({}),[q,r]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(k)p(k.data),r(k.is_published??!1);else{let a={};j.forEach(b=>{a[b.name]=b.default_value||""}),p(a),r(!1)}},[k,j,a]);let s=async a=>{a.preventDefault(),n(!0);try{let{data:{user:a}}=await e.supabase.auth.getUser();if(!a)return void h.toast.error("You must be logged in");for(let a of j)if(a.is_required&&(!o[a.name]||""===o[a.name])){h.toast.error(`${a.display_name} is required`),n(!1);return}if(k){let{error:a}=await e.supabase.from("entity_records").update({data:o,is_published:q}).eq("id",k.id);if(a)throw a;h.toast.success("Record updated successfully")}else{let{data:b}=await e.supabase.from("entities").select("id").eq("id",i).single();if(!b){let b=await (0,af.getEntity)(i);if(b){let{error:c}=await e.supabase.from("entities").insert({id:i,name:b.name,display_name:b.display_name,description:b.description,user_id:a.id});c&&console.error("Failed to sync entity to Supabase:",c)}}let{error:c}=await e.supabase.from("entity_records").insert({entity_id:i,user_id:a.id,data:o,is_published:q});if(c)throw c;h.toast.success("Record created successfully")}d(!1),l()}catch(a){console.error(a),h.toast.error(a.message||"An error occurred")}finally{n(!1)}};return(0,b.jsx)(aa.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(aa.DialogContent,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,b.jsxs)(aa.DialogHeader,{children:[(0,b.jsx)(aa.DialogTitle,{children:k?"Edit Record":"Create New Record"}),(0,b.jsx)(aa.DialogDescription,{children:k?"Update the record details below":"Fill in the details for the new record"})]}),(0,b.jsxs)("form",{onSubmit:s,children:[(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[j.map(a=>(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(ab.Label,{htmlFor:a.name,children:[a.display_name,a.is_required&&(0,b.jsx)("span",{className:"text-destructive ml-1",children:"*"})]}),(a=>{let c=o[a.name]||"";switch(a.field_type){case ae.E_FieldDataType.TextArea:return(0,b.jsx)(ac.Textarea,{id:a.name,value:c,onChange:b=>p({...o,[a.name]:b.target.value}),required:a.is_required,rows:4});case ae.E_FieldDataType.Boolean:return(0,b.jsx)(ad.Switch,{checked:"true"===c||!0===c,onCheckedChange:b=>p({...o,[a.name]:b})});case ae.E_FieldDataType.Interger:return(0,b.jsx)(g.Input,{id:a.name,type:"number",value:c,onChange:b=>p({...o,[a.name]:b.target.value}),required:a.is_required});case ae.E_FieldDataType.Date:return(0,b.jsx)(g.Input,{id:a.name,type:"date",value:c,onChange:b=>p({...o,[a.name]:b.target.value}),required:a.is_required});default:return(0,b.jsx)(g.Input,{id:a.name,type:a.field_type===ae.E_FieldDataType.Image?"url":"text",value:c,onChange:b=>p({...o,[a.name]:b.target.value}),required:a.is_required,placeholder:a.field_type===ae.E_FieldDataType.Image?"https://...":""})}})(a)]},a.name)),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t",children:[(0,b.jsx)(ab.Label,{children:"Published"}),(0,b.jsx)(ad.Switch,{checked:q,onCheckedChange:r})]})]}),(0,b.jsxs)(aa.DialogFooter,{children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,b.jsx)(f.Button,{type:"submit",disabled:m,children:m?"Saving...":k?"Update":"Create"})]})]})]})})};var ah=a.i(80701),ai=a.i(57061),aj=a.i(15055),ak=a.i(75083);let al=(0,o.default)("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);var am=a.i(9941),an=a.i(14548),ao=a.i(98429);let ap=({entityId:a,fields:d,viewOptions:i,onViewOptionsChange:j,currentViewName:k,currentViewId:l,onViewSaved:m})=>{let[n,o]=(0,c.useState)(!1),[p,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(!1),B=async()=>{let b=z?p:p||k;if(!b?.trim())return void h.toast.error("Please enter a view name");let{data:{user:c}}=await e.supabase.auth.getUser();if(!c)return void h.toast.error("You must be logged in to save views");if(!z&&l){let{error:a}=await e.supabase.from("entity_views").update({name:b,view_config:i}).eq("id",l);a?(h.toast.error("Failed to update view"),console.error(a)):(h.toast.success("View updated successfully"),y(""),A(!1),o(!1),m?.())}else{let{error:d}=await e.supabase.from("entity_views").insert([{entity_id:a,name:b,view_config:i,is_default:!1,user_id:c.id}]);d?(h.toast.error("Failed to save view"),console.error(d)):(h.toast.success("View saved successfully"),y(""),A(!1),o(!1),m?.())}};return(0,b.jsxs)(ai.Sheet,{open:n,onOpenChange:o,children:[(0,b.jsx)(ai.SheetTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(al,{className:"h-4 w-4 mr-2"}),"View Options"]})}),(0,b.jsxs)(ai.SheetContent,{children:[(0,b.jsx)(ai.SheetHeader,{children:(0,b.jsx)(ai.SheetTitle,{children:"View Options"})}),(0,b.jsxs)(ak.Tabs,{value:i.viewType||"table",onValueChange:a=>j({...i,viewType:a}),className:"mt-6",children:[(0,b.jsxs)(ak.TabsList,{className:"grid grid-cols-4 mb-4",children:[(0,b.jsxs)(ak.TabsTrigger,{value:"table",className:"text-xs",children:[(0,b.jsx)(q.Table2,{className:"h-3 w-3 mr-1"}),"Table"]}),(0,b.jsxs)(ak.TabsTrigger,{value:"card",className:"text-xs",children:[(0,b.jsx)(r.LayoutGrid,{className:"h-3 w-3 mr-1"}),"Card"]}),(0,b.jsxs)(ak.TabsTrigger,{value:"kanban",className:"text-xs",children:[(0,b.jsx)(s.Columns3,{className:"h-3 w-3 mr-1"}),"Kanban"]}),(0,b.jsxs)(ak.TabsTrigger,{value:"gallery",className:"text-xs",children:[(0,b.jsx)(t.Images,{className:"h-3 w-3 mr-1"}),"Gallery"]})]}),(0,b.jsxs)(ak.TabsList,{className:"grid grid-cols-4 mb-6",children:[(0,b.jsxs)(ak.TabsTrigger,{value:"list",className:"text-xs",children:[(0,b.jsx)(u.List,{className:"h-3 w-3 mr-1"}),"List"]}),(0,b.jsxs)(ak.TabsTrigger,{value:"timeline",className:"text-xs",children:[(0,b.jsx)(v.Clock,{className:"h-3 w-3 mr-1"}),"Timeline"]}),(0,b.jsxs)(ak.TabsTrigger,{value:"calendar",className:"text-xs",children:[(0,b.jsx)(w.Calendar,{className:"h-3 w-3 mr-1"}),"Calendar"]}),(0,b.jsxs)(ak.TabsTrigger,{value:"gantt",className:"text-xs",children:[(0,b.jsx)(x.BarChart3,{className:"h-3 w-3 mr-1"}),"Gantt"]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(ak.TabsContent,{value:"table",className:"space-y-6 mt-0",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(ab.Label,{className:"text-base font-semibold",children:"Visible Columns"}),(0,b.jsx)("div",{className:"space-y-2",children:d.map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(aj.Checkbox,{id:`col-${a.name}`,checked:i.visibleColumns.includes(a.name),onCheckedChange:b=>{var c;let d;return c=a.name,d=b?[...i.visibleColumns,c]:i.visibleColumns.filter(a=>a!==c),void j({...i,visibleColumns:d})}}),(0,b.jsx)(ab.Label,{htmlFor:`col-${a.name}`,className:"font-normal cursor-pointer",children:a.display_name})]},a.name))})]})}),(0,b.jsx)(ak.TabsContent,{value:"card",className:"space-y-6 mt-0",children:(0,b.jsx)(ao.CardLayoutEditor,{fields:d,layout:i.cardLayout||{titleField:d[0]?.name||"",displayFields:[]},onChange:a=>j({...i,cardLayout:a})})}),(0,b.jsxs)(ak.TabsContent,{value:"kanban",className:"space-y-6 mt-0",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"Group By Field *"}),(0,b.jsxs)(ah.Select,{value:i.kanbanConfig?.groupByField||"none",onValueChange:a=>j({...i,kanbanConfig:{groupByField:a,cardLayout:i.kanbanConfig?.cardLayout||{titleField:d[0]?.name||"",displayFields:[]}}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"Select field to group by"})}),(0,b.jsxs)(ah.SelectContent,{children:[(0,b.jsx)(ah.SelectItem,{value:"none",children:"None"}),d.filter(a=>a.field_type===ae.E_FieldDataType.String).map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))]})]})]}),(0,b.jsxs)("div",{className:"pt-4 border-t",children:[(0,b.jsx)(ab.Label,{className:"text-base font-semibold mb-4 block",children:"Card Configuration"}),(0,b.jsx)(ao.CardLayoutEditor,{fields:d,layout:i.kanbanConfig?.cardLayout||{titleField:d[0]?.name||"",displayFields:[]},onChange:a=>j({...i,kanbanConfig:{groupByField:i.kanbanConfig?.groupByField||"",cardLayout:a}}),showImageField:!1})]})]}),(0,b.jsxs)(ak.TabsContent,{value:"gallery",className:"space-y-6 mt-0",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"Image Field *"}),(0,b.jsxs)(ah.Select,{value:i.galleryConfig?.imageField||"none",onValueChange:a=>j({...i,galleryConfig:{imageField:a,titleField:i.galleryConfig?.titleField||d[0]?.name||""}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"Select image field"})}),(0,b.jsxs)(ah.SelectContent,{children:[(0,b.jsx)(ah.SelectItem,{value:"none",children:"None"}),d.filter(a=>a.field_type===ae.E_FieldDataType.Image).map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"Title Field *"}),(0,b.jsxs)(ah.Select,{value:i.galleryConfig?.titleField||d[0]?.name,onValueChange:a=>j({...i,galleryConfig:{imageField:i.galleryConfig?.imageField||"",titleField:a}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"Select title field"})}),(0,b.jsx)(ah.SelectContent,{children:d.map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))})]})]})]}),(0,b.jsx)(ak.TabsContent,{value:"list",className:"space-y-6 mt-0",children:(0,b.jsx)(ao.CardLayoutEditor,{fields:d,layout:i.listConfig||{titleField:d[0]?.name||"",displayFields:[]},onChange:a=>j({...i,listConfig:a}),showImageField:!1})}),(0,b.jsxs)(ak.TabsContent,{value:"timeline",className:"space-y-6 mt-0",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"Date Field *"}),(0,b.jsxs)(ah.Select,{value:i.timelineConfig?.dateField||"none",onValueChange:a=>j({...i,timelineConfig:{dateField:a,titleField:i.timelineConfig?.titleField||d[0]?.name||""}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"Select date field"})}),(0,b.jsxs)(ah.SelectContent,{children:[(0,b.jsx)(ah.SelectItem,{value:"none",children:"None"}),d.filter(a=>a.field_type===ae.E_FieldDataType.Date).map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"Title Field *"}),(0,b.jsxs)(ah.Select,{value:i.timelineConfig?.titleField||d[0]?.name,onValueChange:a=>j({...i,timelineConfig:{dateField:i.timelineConfig?.dateField||"",titleField:a}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"Select title field"})}),(0,b.jsx)(ah.SelectContent,{children:d.map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))})]})]})]}),(0,b.jsxs)(ak.TabsContent,{value:"calendar",className:"space-y-6 mt-0",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"Date Field *"}),(0,b.jsxs)(ah.Select,{value:i.calendarConfig?.dateField||"none",onValueChange:a=>j({...i,calendarConfig:{dateField:a,titleField:i.calendarConfig?.titleField||d[0]?.name||""}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"Select date field"})}),(0,b.jsxs)(ah.SelectContent,{children:[(0,b.jsx)(ah.SelectItem,{value:"none",children:"None"}),d.filter(a=>a.field_type===ae.E_FieldDataType.Date).map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"Title Field *"}),(0,b.jsxs)(ah.Select,{value:i.calendarConfig?.titleField||d[0]?.name,onValueChange:a=>j({...i,calendarConfig:{dateField:i.calendarConfig?.dateField||"",titleField:a}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"Select title field"})}),(0,b.jsx)(ah.SelectContent,{children:d.map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))})]})]})]}),(0,b.jsxs)(ak.TabsContent,{value:"gantt",className:"space-y-6 mt-0",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"Start Date Field *"}),(0,b.jsxs)(ah.Select,{value:i.ganttConfig?.startDateField||"none",onValueChange:a=>j({...i,ganttConfig:{startDateField:a,endDateField:i.ganttConfig?.endDateField||"",titleField:i.ganttConfig?.titleField||d[0]?.name||""}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"Select start date field"})}),(0,b.jsxs)(ah.SelectContent,{children:[(0,b.jsx)(ah.SelectItem,{value:"none",children:"None"}),d.filter(a=>a.field_type===ae.E_FieldDataType.Date).map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"End Date Field *"}),(0,b.jsxs)(ah.Select,{value:i.ganttConfig?.endDateField||"none",onValueChange:a=>j({...i,ganttConfig:{startDateField:i.ganttConfig?.startDateField||"",endDateField:a,titleField:i.ganttConfig?.titleField||d[0]?.name||""}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"Select end date field"})}),(0,b.jsxs)(ah.SelectContent,{children:[(0,b.jsx)(ah.SelectItem,{value:"none",children:"None"}),d.filter(a=>a.field_type===ae.E_FieldDataType.Date).map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"Title Field *"}),(0,b.jsxs)(ah.Select,{value:i.ganttConfig?.titleField||d[0]?.name,onValueChange:a=>j({...i,ganttConfig:{startDateField:i.ganttConfig?.startDateField||"",endDateField:i.ganttConfig?.endDateField||"",titleField:a}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"Select title field"})}),(0,b.jsx)(ah.SelectContent,{children:d.map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"Group By (Optional)"}),(0,b.jsxs)(ah.Select,{value:i.ganttConfig?.groupByField||"none",onValueChange:a=>j({...i,ganttConfig:{...i.ganttConfig,groupByField:"none"===a?void 0:a}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"None"})}),(0,b.jsxs)(ah.SelectContent,{children:[(0,b.jsx)(ah.SelectItem,{value:"none",children:"None"}),d.filter(a=>a.field_type===ae.E_FieldDataType.String).map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"Color By (Optional)"}),(0,b.jsxs)(ah.Select,{value:i.ganttConfig?.colorByField||"none",onValueChange:a=>j({...i,ganttConfig:{...i.ganttConfig,colorByField:"none"===a?void 0:a}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"None"})}),(0,b.jsxs)(ah.SelectContent,{children:[(0,b.jsx)(ah.SelectItem,{value:"none",children:"None"}),d.map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"Dependencies Field (Optional)"}),(0,b.jsxs)(ah.Select,{value:i.ganttConfig?.dependenciesField||"none",onValueChange:a=>j({...i,ganttConfig:{...i.ganttConfig,dependenciesField:"none"===a?void 0:a}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"None"})}),(0,b.jsxs)(ah.SelectContent,{children:[(0,b.jsx)(ah.SelectItem,{value:"none",children:"None"}),d.map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Field containing comma-separated IDs or JSON array of dependent task IDs"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(ab.Label,{className:"text-sm font-medium",children:"Progress Field (Optional)"}),(0,b.jsxs)(ah.Select,{value:i.ganttConfig?.progressField||"none",onValueChange:a=>j({...i,ganttConfig:{...i.ganttConfig,progressField:"none"===a?void 0:a}}),children:[(0,b.jsx)(ah.SelectTrigger,{className:"mt-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"None"})}),(0,b.jsxs)(ah.SelectContent,{children:[(0,b.jsx)(ah.SelectItem,{value:"none",children:"None"}),d.filter(a=>a.field_type===ae.E_FieldDataType.Interger).map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Field containing a number between 0-100 representing completion percentage"})]})]}),(0,b.jsxs)("div",{className:"space-y-3 pt-6 border-t",children:[(0,b.jsx)(ab.Label,{className:"text-base font-semibold",children:"Sort By"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(ah.Select,{value:i.sortField||"none",onValueChange:a=>{j({...i,sortField:"none"===a?null:a})},children:[(0,b.jsx)(ah.SelectTrigger,{className:"flex-1",children:(0,b.jsx)(ah.SelectValue,{placeholder:"Select field to sort"})}),(0,b.jsxs)(ah.SelectContent,{children:[(0,b.jsx)(ah.SelectItem,{value:"none",children:"None"}),d.map(a=>(0,b.jsx)(ah.SelectItem,{value:a.name,children:a.display_name},a.name))]})]}),i.sortField&&(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>{j({...i,sortOrder:"asc"===i.sortOrder?"desc":"asc"})},className:"px-3",title:"asc"===i.sortOrder?"Ascending":"Descending",children:(0,b.jsx)(am.ArrowUpDown,{className:"h-4 w-4"})})]})]})]}),(0,b.jsxs)("div",{className:"space-y-3 pt-6 border-t",children:[(0,b.jsx)(ab.Label,{className:"text-base font-semibold",children:"Save View"}),k&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Current View: ",(0,b.jsx)("span",{className:"font-medium",children:k})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[k&&(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(aj.Checkbox,{id:"save-as-new",checked:z,onCheckedChange:a=>A(a)}),(0,b.jsx)(ab.Label,{htmlFor:"save-as-new",className:"font-normal cursor-pointer",children:"Save as new view"})]}),(z||!k)&&(0,b.jsx)(g.Input,{placeholder:"Enter view name...",value:p,onChange:a=>y(a.target.value)}),(0,b.jsxs)(f.Button,{onClick:B,className:"w-full",children:[(0,b.jsx)(an.Save,{className:"h-4 w-4 mr-2"}),z?"Save as New":k?"Update View":"Save View"]})]})]})]})]})]})};var aq=a.i(86192);let ar=(0,c.forwardRef)(({entityId:a,currentView:d,onViewLoad:i,onViewNameChange:j,onViewIdChange:k},m)=>{let[n,o]=(0,c.useState)([]),[p,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!1),H=async()=>{let{data:{user:b}}=await e.supabase.auth.getUser();if(!b)return;let{data:c,error:d}=await e.supabase.from("entity_views").select("*").eq("entity_id",a).order("created_at");if(d)console.error("Error loading views:",d);else if(o((c||[]).map(a=>({...a,is_default:!!a.is_default}))),!F){let a=c?.find(a=>a.is_default);a&&(y(a.id),i(a.view_config),j?.(a.name),k?.(a.id),G(!0))}};(0,c.useEffect)(()=>{H()},[a]),(0,c.useImperativeHandle)(m,()=>({refreshViews:H}));let I=async()=>{if(!B.trim())return void h.toast.error("Please enter a view name");let{data:{user:b}}=await e.supabase.auth.getUser();if(!b)return;let{error:c}=await e.supabase.from("entity_views").insert([{entity_id:a,user_id:b.id,name:B,view_config:d}]);c?(h.toast.error("Failed to save view"),console.error(c)):(h.toast.success("View saved successfully"),C(""),A(!1),H())},J=async()=>{if(!D)return;let{error:a}=await e.supabase.from("entity_views").delete().eq("id",D);a?(h.toast.error("Failed to delete view"),console.error(a)):(h.toast.success("View deleted"),p===D&&y(null),H()),E(null)};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(ah.Select,{value:p||"default",onValueChange:a=>{if("default"===a){y(null),j?.("Default View"),k?.(null);return}let b=n.find(b=>b.id===a);b&&(y(a),i(b.view_config),j?.(b.name),k?.(a))},children:[(0,b.jsx)(ah.SelectTrigger,{className:"w-48",children:(0,b.jsx)(ah.SelectValue,{placeholder:"Select view"})}),(0,b.jsxs)(ah.SelectContent,{className:"bg-popover z-50",children:[(0,b.jsx)(ah.SelectItem,{value:"default",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(q.Table2,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Default View"})]})}),n.map(a=>(0,b.jsx)(ah.SelectItem,{value:a.id,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(a=>{switch(a){case"table":default:return(0,b.jsx)(q.Table2,{className:"h-4 w-4"});case"card":return(0,b.jsx)(r.LayoutGrid,{className:"h-4 w-4"});case"kanban":return(0,b.jsx)(s.Columns3,{className:"h-4 w-4"});case"gallery":return(0,b.jsx)(t.Images,{className:"h-4 w-4"});case"list":return(0,b.jsx)(u.List,{className:"h-4 w-4"});case"timeline":return(0,b.jsx)(v.Clock,{className:"h-4 w-4"});case"calendar":return(0,b.jsx)(w.Calendar,{className:"h-4 w-4"});case"gantt":return(0,b.jsx)(x.BarChart3,{className:"h-4 w-4"})}})(a.view_config?.viewType),(0,b.jsx)("span",{children:a.name})]})},a.id))]})]}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>A(!0),children:[(0,b.jsx)(an.Save,{className:"h-4 w-4 mr-2"}),"Save View"]}),p&&"default"!==p&&(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>E(p),children:(0,b.jsx)(l.Trash2,{className:"h-4 w-4"})})]}),(0,b.jsx)(aa.Dialog,{open:z,onOpenChange:A,children:(0,b.jsxs)(aa.DialogContent,{children:[(0,b.jsxs)(aa.DialogHeader,{children:[(0,b.jsx)(aa.DialogTitle,{children:"Save View"}),(0,b.jsx)(aa.DialogDescription,{children:"Give this view a name to save your current column selection, sorting, and filters."})]}),(0,b.jsx)(g.Input,{placeholder:"View name",value:B,onChange:a=>C(a.target.value),onKeyDown:a=>"Enter"===a.key&&I()}),(0,b.jsxs)(aa.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>A(!1),children:"Cancel"}),(0,b.jsx)(f.Button,{onClick:I,children:"Save"})]})]})}),(0,b.jsx)(aq.AlertDialog,{open:!!D,onOpenChange:()=>E(null),children:(0,b.jsxs)(aq.AlertDialogContent,{children:[(0,b.jsxs)(aq.AlertDialogHeader,{children:[(0,b.jsx)(aq.AlertDialogTitle,{children:"Delete View"}),(0,b.jsx)(aq.AlertDialogDescription,{children:"Are you sure you want to delete this saved view? This action cannot be undone."})]}),(0,b.jsxs)(aq.AlertDialogFooter,{children:[(0,b.jsx)(aq.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(aq.AlertDialogAction,{onClick:J,children:"Delete"})]})]})})]})});ar.displayName="ViewSelector";var as=a.i(63956),at=a.i(86036),au=a.i(24290),av=a.i(3274),aw=a.i(19017),ax=a.i(83519),ay=a.i(3983),az=a.i(6015),aA=a.i(86304);a.s(["default",0,()=>{let a=(0,d.useRouter)(),o=(0,d.useParams)().entityId,[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)([]),[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)(!0),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(null),[O,P]=(0,c.useState)({visibleColumns:[],sortField:null,sortOrder:"asc",filters:[]}),[Q,R]=(0,c.useState)("Default View"),[S,T]=(0,c.useState)(null),U=(0,c.useRef)(null);(0,c.useEffect)(()=>{V()},[o]);let V=async()=>{if(!o)return;F(!0);let a=await (0,af.getEntity)(o),b=await (0,af.getFields)(o),{data:c,error:d}=await e.supabase.from("entity_records").select("*").eq("entity_id",o).order("created_at",{ascending:!1});if(!a||d)h.toast.error("Failed to load data"),console.error({recordsError:d});else{z(a);let d=b||[];B(d),D(c||[]),0===O.visibleColumns.length&&d.length>0&&P(a=>({...a,visibleColumns:d.map(a=>a.id)}))}F(!1)},W=async()=>{if(!M)return;let{error:a}=await e.supabase.from("entity_records").delete().eq("id",M);a?(h.toast.error("Failed to delete record"),console.error(a)):(h.toast.success("Record deleted"),V()),N(null)},X=async(a,b)=>{let{error:c}=await e.supabase.from("entity_records").update({is_published:!b}).eq("id",a);c?(h.toast.error("Failed to update record"),console.error(c)):(h.toast.success(`Record ${!b?"published":"unpublished"}`),V())},aa=async b=>{a.push(`/admin/entities/${o}/editor`)},ab=[...C.filter(a=>!G||Object.values(a.data).some(a=>String(a).toLowerCase().includes(G.toLowerCase())))].sort((a,b)=>{if(!O.sortField)return 0;let c=a.data[O.sortField],d=b.data[O.sortField];if(c===d)return 0;let e=c>d?1:-1;return"asc"===O.sortOrder?e:-e}),ac=A.filter(a=>O.visibleColumns.includes(a.id));return E?(0,b.jsx)($.AdminLayout,{children:(0,b.jsx)("div",{className:"p-8",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto text-center py-12 text-muted-foreground",children:"Loading records..."})})}):y?(0,b.jsxs)($.AdminLayout,{children:[(0,b.jsx)("div",{className:"p-8",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"icon",onClick:()=>a.push("/admin/entities"),children:(0,b.jsx)(i.ArrowLeft,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:y.display_name}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Manage entity records"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(ap,{entityId:o,fields:A,viewOptions:O,onViewOptionsChange:P,currentViewName:Q,currentViewId:S,onViewSaved:()=>U.current?.refreshViews()}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>aa(o),children:[(0,b.jsx)(p,{className:"h-4 w-4 mr-2"}),"Edit Fields"]}),(0,b.jsxs)(f.Button,{onClick:()=>{L(null),J(!0)},children:[(0,b.jsx)(j.Plus,{className:"h-4 w-4 mr-2"}),"Add Record"]})]})]}),(0,b.jsxs)(_.Card,{className:"p-6",children:[(0,b.jsxs)("div",{className:"mb-4 space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,b.jsx)(ar,{ref:U,entityId:o,currentView:O,onViewLoad:P,onViewNameChange:R,onViewIdChange:T}),(0,b.jsx)("div",{className:"flex-1 min-w-[200px]",children:(0,b.jsxs)(Y,{type:"single",value:O.viewType||"table",onValueChange:a=>{a&&P({...O,viewType:a})},className:"justify-start",children:[(0,b.jsx)(Z,{value:"table","aria-label":"Table view",title:"Table",children:(0,b.jsx)(q.Table2,{className:"h-4 w-4"})}),(0,b.jsx)(Z,{value:"card","aria-label":"Card view",title:"Card",children:(0,b.jsx)(r.LayoutGrid,{className:"h-4 w-4"})}),(0,b.jsx)(Z,{value:"kanban","aria-label":"Kanban view",title:"Kanban",children:(0,b.jsx)(s.Columns3,{className:"h-4 w-4"})}),(0,b.jsx)(Z,{value:"gallery","aria-label":"Gallery view",title:"Gallery",children:(0,b.jsx)(t.Images,{className:"h-4 w-4"})}),(0,b.jsx)(Z,{value:"list","aria-label":"List view",title:"List",children:(0,b.jsx)(u.List,{className:"h-4 w-4"})}),(0,b.jsx)(Z,{value:"timeline","aria-label":"Timeline view",title:"Timeline",children:(0,b.jsx)(v.Clock,{className:"h-4 w-4"})}),(0,b.jsx)(Z,{value:"calendar","aria-label":"Calendar view",title:"Calendar",children:(0,b.jsx)(w.Calendar,{className:"h-4 w-4"})}),(0,b.jsx)(Z,{value:"gantt","aria-label":"Gantt view",title:"Gantt",children:(0,b.jsx)(x.BarChart3,{className:"h-4 w-4"})})]})})]}),(0,b.jsx)(g.Input,{placeholder:"Search records...",value:G,onChange:a=>H(a.target.value)})]}),0===ab.length?(0,b.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:G?"No records match your search":"No records yet"}):(()=>{let a=O.viewType||"table",c={records:ab,fields:A,onEdit:a=>{L(a),J(!0)},onDelete:a=>N(a.id),onTogglePublish:a=>X(a.id,a.is_published)};switch(a){case"card":return(0,b.jsx)(as.CardView,{...c,cardLayout:O.cardLayout});case"kanban":return(0,b.jsx)(at.KanbanView,{...c,kanbanConfig:O.kanbanConfig});case"gallery":return(0,b.jsx)(au.GalleryView,{...c,galleryConfig:O.galleryConfig});case"list":return(0,b.jsx)(av.ListView,{...c,listConfig:O.listConfig});case"timeline":return(0,b.jsx)(aw.TimelineView,{...c,timelineConfig:O.timelineConfig});case"calendar":return(0,b.jsx)(ax.CalendarView,{...c,calendarConfig:O.calendarConfig});case"gantt":return(0,b.jsx)(ay.GanttView,{...c,ganttConfig:O.ganttConfig,entityId:o});default:return(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(az.Table,{children:[(0,b.jsx)(az.TableHeader,{children:(0,b.jsxs)(az.TableRow,{children:[(0,b.jsx)(az.TableHead,{className:"w-24",children:"Status"}),ac.map(a=>(0,b.jsx)(az.TableHead,{className:"min-w-[150px]",children:(0,b.jsx)("div",{className:"flex items-center justify-between",children:a.display_name})},a.id)),(0,b.jsx)(az.TableHead,{className:"w-32 text-right sticky right-0 bg-card",children:"Actions"})]})}),(0,b.jsx)(az.TableBody,{children:ab.map(a=>(0,b.jsxs)(az.TableRow,{children:[(0,b.jsx)(az.TableCell,{children:(0,b.jsx)(aA.Badge,{variant:a.is_published?"default":"secondary",children:a.is_published?"Published":"Draft"})}),ac.map(c=>(0,b.jsx)(az.TableCell,{className:"max-w-xs",children:(0,b.jsx)("div",{className:"truncate",children:c.field_type===ae.E_FieldDataType.Boolean?a.data[c.name]?"✓":"✗":a.data[c.name]||"-"})},c.id)),(0,b.jsx)(az.TableCell,{className:"sticky right-0 bg-card",children:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",onClick:()=>X(a.id,a.is_published),children:a.is_published?(0,b.jsx)(n.EyeOff,{className:"h-4 w-4"}):(0,b.jsx)(m.Eye,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",onClick:()=>{L(a),J(!0)},children:(0,b.jsx)(k.Edit,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",onClick:()=>N(a.id),children:(0,b.jsx)(l.Trash2,{className:"h-4 w-4 text-destructive"})})]})})]},a.id))})]})})}})()]})]})}),(0,b.jsx)(ag,{open:I,onOpenChange:J,entityId:o,fields:A,record:K,onSuccess:V}),(0,b.jsx)(aq.AlertDialog,{open:!!M,onOpenChange:()=>N(null),children:(0,b.jsxs)(aq.AlertDialogContent,{children:[(0,b.jsxs)(aq.AlertDialogHeader,{children:[(0,b.jsx)(aq.AlertDialogTitle,{children:"Delete Record"}),(0,b.jsx)(aq.AlertDialogDescription,{children:"Are you sure you want to delete this record? This action cannot be undone."})]}),(0,b.jsxs)(aq.AlertDialogFooter,{children:[(0,b.jsx)(aq.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(aq.AlertDialogAction,{onClick:W,children:"Delete"})]})]})})]}):null}],93353)}];

//# sourceMappingURL=src_views_EntityRecords_tsx_c83f7f22._.js.map