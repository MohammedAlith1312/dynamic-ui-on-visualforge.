module.exports=[14548,a=>{"use strict";let b=(0,a.i(70106).default)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);a.s(["Save",()=>b],14548)},38790,57064,28886,89816,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]);a.s(["Table2",()=>c],38790);let d=(0,b.default)("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);a.s(["LayoutGrid",()=>d],57064);let e=(0,b.default)("Columns3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);a.s(["Columns3",()=>e],28886);let f=(0,b.default)("Images",[["path",{d:"M18 22H4a2 2 0 0 1-2-2V6",key:"pblm9e"}],["path",{d:"m22 13-1.296-1.296a2.41 2.41 0 0 0-3.408 0L11 18",key:"nf6bnh"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["rect",{width:"16",height:"16",x:"6",y:"2",rx:"2",key:"12espp"}]]);a.s(["Images",()=>f],89816)},39761,a=>{"use strict";let b=(0,a.i(70106).default)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);a.s(["BarChart3",()=>b],39761)},9941,98429,a=>{"use strict";let b=(0,a.i(70106).default)("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);a.s(["ArrowUpDown",()=>b],9941);var c=a.i(87924),d=a.i(70430),e=a.i(80701),f=a.i(15055),g=a.i(84581),h=a.i(34767);a.s(["CardLayoutEditor",0,({fields:a,layout:b,onChange:i,showImageField:j=!0})=>{let k=a.filter(a=>a.field_type===h.E_FieldDataType.Image);return(0,c.jsxs)("div",{className:"space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)(d.Label,{className:"text-sm font-medium",children:"Title Field *"}),(0,c.jsxs)(e.Select,{value:b.titleField,onValueChange:a=>i({...b,titleField:a}),children:[(0,c.jsx)(e.SelectTrigger,{className:"mt-1",children:(0,c.jsx)(e.SelectValue,{placeholder:"Select title field"})}),(0,c.jsx)(e.SelectContent,{children:a.map(a=>(0,c.jsx)(e.SelectItem,{value:a.name,children:a.display_name},a.name))})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(d.Label,{className:"text-sm font-medium",children:"Subtitle Field (Optional)"}),(0,c.jsxs)(e.Select,{value:b.subtitleField||"none",onValueChange:a=>i({...b,subtitleField:"none"===a?void 0:a}),children:[(0,c.jsx)(e.SelectTrigger,{className:"mt-1",children:(0,c.jsx)(e.SelectValue,{placeholder:"Select subtitle field"})}),(0,c.jsxs)(e.SelectContent,{children:[(0,c.jsx)(e.SelectItem,{value:"none",children:"None"}),a.map(a=>(0,c.jsx)(e.SelectItem,{value:a.name,children:a.display_name},a.name))]})]})]}),j&&k.length>0&&(0,c.jsxs)("div",{children:[(0,c.jsx)(d.Label,{className:"text-sm font-medium",children:"Image Field (Optional)"}),(0,c.jsxs)(e.Select,{value:b.imageField||"none",onValueChange:a=>i({...b,imageField:"none"===a?void 0:a}),children:[(0,c.jsx)(e.SelectTrigger,{className:"mt-1",children:(0,c.jsx)(e.SelectValue,{placeholder:"Select image field"})}),(0,c.jsxs)(e.SelectContent,{children:[(0,c.jsx)(e.SelectItem,{value:"none",children:"None"}),k.map(a=>(0,c.jsx)(e.SelectItem,{value:a.name,children:a.display_name},a.name))]})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)(d.Label,{className:"text-sm font-medium mb-2 block",children:"Additional Fields to Display"}),(0,c.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:a.map(a=>{let e=b.displayFields.some(b=>b.fieldId===a.name),h=a.name===b.titleField,j=a.name===b.subtitleField,k=a.name===b.imageField,l=h||j||k;return(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)(g.GripVertical,{className:"h-4 w-4 text-muted-foreground"}),(0,c.jsx)(f.Checkbox,{id:`display-${a.name}`,checked:e,disabled:l,onCheckedChange:c=>{var d;let e;return d=a.name,e=c?[...b.displayFields,{fieldId:d,position:b.displayFields.length}]:b.displayFields.filter(a=>a.fieldId!==d),void i({...b,displayFields:e})}}),(0,c.jsxs)(d.Label,{htmlFor:`display-${a.name}`,className:`font-normal cursor-pointer flex-1 ${l?"text-muted-foreground":""}`,children:[a.display_name,l&&(0,c.jsxs)("span",{className:"text-xs ml-2",children:["(Used as ",h?"title":j?"subtitle":"image",")"]})]})]},a.name)})})]})]})}],98429)},57061,a=>{"use strict";var b=a.i(87924),c=a.i(97942),d=a.i(187),e=a.i(33508),f=a.i(72131),g=a.i(68114);let h=c.Root,i=c.Trigger;c.Close;let j=c.Portal,k=f.forwardRef(({className:a,...d},e)=>(0,b.jsx)(c.Overlay,{className:(0,g.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...d,ref:e}));k.displayName=c.Overlay.displayName;let l=(0,d.cva)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),m=f.forwardRef(({side:a="right",className:d,children:f,...h},i)=>(0,b.jsxs)(j,{children:[(0,b.jsx)(k,{}),(0,b.jsxs)(c.Content,{ref:i,className:(0,g.cn)(l({side:a}),d),...h,children:[f,(0,b.jsxs)(c.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[(0,b.jsx)(e.X,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));m.displayName=c.Content.displayName;let n=({className:a,...c})=>(0,b.jsx)("div",{className:(0,g.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...c});n.displayName="SheetHeader";let o=f.forwardRef(({className:a,...d},e)=>(0,b.jsx)(c.Title,{ref:e,className:(0,g.cn)("text-lg font-semibold text-foreground",a),...d}));o.displayName=c.Title.displayName,f.forwardRef(({className:a,...d},e)=>(0,b.jsx)(c.Description,{ref:e,className:(0,g.cn)("text-sm text-muted-foreground",a),...d})).displayName=c.Description.displayName,a.s(["Sheet",()=>h,"SheetContent",()=>m,"SheetHeader",()=>n,"SheetTitle",()=>o,"SheetTrigger",()=>i])},5151,a=>{"use strict";let b=(0,a.i(70106).default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);a.s(["Copy",()=>b],5151)},44494,a=>{"use strict";let b=(0,a.i(70106).default)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);a.s(["Globe",()=>b],44494)},14730,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(74167),f=a.i(99570),g=a.i(66718),h=a.i(23292),i=a.i(210),j=a.i(14548),k=a.i(9599),l=a.i(67438),m=a.i(88621),n=a.i(49741);a.s(["default",0,()=>{let a=(0,d.useParams)().templateId,o=(0,d.useRouter)(),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(!0),[B,C]=(0,c.useState)(null),[D,E]=(0,c.useState)(null);(0,c.useEffect)(()=>{F()},[a]);let F=async()=>{if(!a)return;let{data:b,error:c}=await e.supabase.from("section_templates").select("*").eq("id",a).single();if(c){h.toast.error("Failed to load template"),o.push("/admin/templates");return}q(b),s(b.name),u(b.description||"");let d={};if(b.template_data)if("string"==typeof b.template_data)try{d=JSON.parse(b.template_data)}catch(a){console.error("Failed to parse template_data:",a)}else"object"==typeof b.template_data&&(d=b.template_data);let f=d.rows||[],g=[],i=[];f.forEach((a,b)=>{let c=`temp-row-${Date.now()}-${b}`;g.push({id:c,columns:a.columns||1,position:b,column_widths:a.column_widths||[],styles:a.styles||{},responsive_config:a.responsive_config||{mobile:{},tablet:{},desktop:{}}}),a.components&&Array.isArray(a.components)&&a.components.forEach((a,d)=>{i.push({id:`temp-comp-${Date.now()}-${b}-${d}`,row_id:c,component_type:a.component_type||"paragraph",column_index:a.column_index||0,position:a.position||d,content:a.content||{},styles:a.styles||{}})})}),console.log("Loaded template data:",{rows:g,components:i}),w(g),y(i),A(!1)},G=async()=>{if(!a)return;let b={rows:v.map(a=>{let b=x.filter(b=>b.row_id===a.id).sort((a,b)=>a.position-b.position).map(a=>({component_type:a.component_type,column_index:a.column_index,position:a.position,content:a.content,styles:a.styles}));return{columns:a.columns,position:a.position,column_widths:a.column_widths,styles:a.styles,responsive_config:a.responsive_config,components:b}})};console.log("Saving template data:",b);let{error:c}=await e.supabase.from("section_templates").update({name:r,description:t,template_data:b}).eq("id",a);if(c){console.error("Save error:",c),h.toast.error("Failed to save template");return}h.toast.success("Template saved successfully")};return z?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}):(0,b.jsx)(m.SidebarProvider,{children:(0,b.jsx)(n.DndContext,{onDragStart:a=>{let{active:b}=a;b.id.startsWith("new-")&&C(b.data.current?.componentType)},onDragEnd:a=>{let{active:b,over:c}=a;if(C(null),!c)return;let d=b.id,e=c.id;if(d.startsWith("new-")){let a=b.data.current?.componentType;if(e.startsWith("column-")){let[,b,c]=e.split("-"),d={id:`temp-comp-${Date.now()}`,row_id:b,component_type:a,column_index:parseInt(c),position:x.filter(a=>a.row_id===b&&a.column_index===parseInt(c)).length,content:(a=>{switch(a){case"heading":return{text:"New Heading",level:"h2"};case"paragraph":return{text:"New paragraph text"};case"image":return{url:"",alt:"Image"};case"button":return{text:"Click me",link:""};case"link":return{text:"Link",url:""};case"video":return{url:""};case"divider":default:return{};case"spacer":return{height:"medium"};case"quote":return{text:"Quote text",author:""};case"list":return{items:"Item 1\nItem 2\nItem 3",type:"bullet"};case"code":return{code:"console.log('Hello');",language:"javascript"};case"chart":return{chartType:"bar",data:JSON.stringify([{name:"Jan",value:400},{name:"Feb",value:300},{name:"Mar",value:600}],null,2),title:"Sample Chart",xAxisKey:"name",yAxisKey:"value"};case"tabs":return{tabs:[{id:"tab-1",label:"Tab 1",content:"Content 1"}]};case"accordion":return{items:[{id:"item-1",title:"Section 1",content:"Content 1"}]};case"card":return{layout:"image-top",title:"Card Title",description:"Card description"};case"form-input":return{fieldName:"field_name",label:"Field Label",placeholder:"Enter value..."};case"form-textarea":return{fieldName:"message",label:"Message",placeholder:"Enter your message..."};case"form-select":return{fieldName:"select_field",label:"Select Option",options:"Option 1\nOption 2"};case"form-checkbox":return{fieldName:"checkbox_field",label:"Select Options",options:"Option 1\nOption 2"};case"form-submit":return{buttonText:"Submit",buttonVariant:"default"}}})(a),styles:{}};y([...x,d]),h.toast.success("Component added")}}},onDragOver:a=>{},children:(0,b.jsxs)("div",{className:"min-h-screen bg-background flex",children:[(0,b.jsx)(l.ComponentsSidebar,{}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,b.jsxs)("header",{className:"border-b bg-card p-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",onClick:()=>o.push("/admin/templates"),children:(0,b.jsx)(i.ArrowLeft,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"flex-1 max-w-md space-y-2",children:[(0,b.jsx)(g.Input,{value:r,onChange:a=>s(a.target.value),className:"font-semibold",placeholder:"Template name..."}),(0,b.jsx)(g.Input,{value:t,onChange:a=>u(a.target.value),placeholder:"Template description...",className:"text-sm"})]})]}),(0,b.jsxs)(f.Button,{onClick:G,className:"gap-2",children:[(0,b.jsx)(j.Save,{className:"h-4 w-4"}),"Save Template"]})]}),(0,b.jsx)("main",{className:"flex-1 overflow-auto p-8",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,b.jsx)("div",{className:"bg-card rounded-lg shadow-lg p-8",children:0===v.length?(0,b.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,b.jsx)("p",{className:"text-lg mb-2",children:"No rows yet"}),(0,b.jsx)("p",{className:"text-sm",children:'Click "Add Row" to start building your template'})]}):(0,b.jsx)(k.GridCanvas,{rows:v,components:x,onUpdateComponent:(a,b)=>{y(x.map(c=>c.id===a?{...c,content:b}:c))},onUpdateComponentStyles:(a,b)=>{y(x.map(c=>c.id===a?{...c,styles:b}:c))},onDeleteComponent:a=>{y(x.filter(b=>b.id!==a)),h.toast.success("Component deleted")},onAddRow:()=>{let a={id:`temp-row-${Date.now()}`,columns:1,position:v.length,column_widths:[],styles:{},responsive_config:{mobile:{},tablet:{},desktop:{}}};w([...v,a])},onDeleteRow:a=>{confirm("Delete this row and all its components?")&&(w(v.filter(b=>b.id!==a)),y(x.filter(b=>b.row_id!==a)),h.toast.success("Row deleted"))},onUpdateRowColumns:(a,b)=>{w(v.map(c=>c.id===a?{...c,columns:b}:c))},onUpdateRowStyles:(a,b)=>{w(v.map(c=>c.id===a?{...c,styles:b}:c))},onReorderRows:a=>{w(a.map((a,b)=>({...a,position:b})))},activeComponentType:B,onDuplicateComponent:a=>{let b=x.find(b=>b.id===a);if(!b)return;let c={...b,id:`temp-comp-${Date.now()}`,position:x.filter(a=>a.row_id===b.row_id).length};y([...x,c]),h.toast.success("Component duplicated")},onPasteComponent:(a,b)=>{h.toast.info("Paste not available in template editor")},onMoveComponentToPosition:(a,b)=>{let c=x.find(b=>b.id===a);if(!c)return;let d=x.filter(a=>a.row_id===c.row_id&&a.column_index===c.column_index).sort((a,b)=>a.position-b.position);y(x.map(e=>{if(e.id===a)return{...e,position:b};let f=d.findIndex(a=>a.id===e.id);if(f>=0){if(f>=b&&e.position<c.position)return{...e,position:f+1};if(f<=b&&e.position>c.position)return{...e,position:f-1}}return e})),h.toast.success("Component moved")},onAddRowAbove:a=>{let b=v.find(b=>b.id===a);if(!b)return;let c={id:`temp-row-${Date.now()}`,position:b.position,columns:1,column_widths:[],styles:{},responsive_config:{mobile:{},tablet:{},desktop:{}}};w([...v.map(a=>a.position>=b.position?{...a,position:a.position+1}:a),c].sort((a,b)=>a.position-b.position)),h.toast.success("Row added")},onAddRowBelow:a=>{let b=v.find(b=>b.id===a);if(!b)return;let c={id:`temp-row-${Date.now()}`,position:b.position+1,columns:1,column_widths:[],styles:{},responsive_config:{mobile:{},tablet:{},desktop:{}}};w([...v.map(a=>a.position>b.position?{...a,position:a.position+1}:a),c].sort((a,b)=>a.position-b.position)),h.toast.success("Row added")},onDuplicateRow:a=>{let b=v.find(b=>b.id===a);if(!b)return;let c=`temp-row-${Date.now()}`,d={...b,id:c,position:b.position+1},e=x.filter(b=>b.row_id===a).map(a=>({...a,id:`temp-comp-${Date.now()}-${Math.random()}`,row_id:c}));w([...v,d].sort((a,b)=>a.position-b.position)),y([...x,...e]),h.toast.success("Row duplicated")}})})})})]})]})})})}])},59789,a=>{a.v(a=>Promise.resolve().then(()=>a(23952)))}];

//# sourceMappingURL=_573f0fd5._.js.map